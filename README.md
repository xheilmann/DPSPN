# Differentially Private Sum-Product Networks

We here provide a method based on sum-product networks that is able to both generate private synthetic data and perform classification in a single training run. Additionally, density estimation for e.g. binary datasets is supported.
These models, when trained for a classification task, may be also employed to generate DP synthetic data without any retraining or adaptation required. 

# Manual Setup
We support python3, and the dependencies can be installed via pip as follows:
```
$ pip install requirements.txt
```

## Reproduce experimental results
We provide three different run files. All input parameters are described in detail in the separate files. 
1. `evaluate.py` for evaluation of DPSPNs on classification datasets 
2. `evaluate-non-classification.py` for evaluation of DPSPN performance on binary datasets with density estimation
3. `compare.py` for comparing DPSPN generated synthetic data with synthetic data generated by MST, PATE-GAN and PrivBayes 


These files can be called with e.g.
```
$ python evaluate.py --train-data-path=/data/adult/adult_train.csv --test-data-path=/data/adult/adult_test.csv --feature-data-path=/data/adult/adult_features.csv --target-variable="income>50K" --result-data-path=/data/adult/results.csv --enable-privacy --spn-slice=36632 --threshold=0.5 --dpspn-slice=19305 --iteration=1 --epsilon=1.0
```